<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Th√ºringer Tannenhof ‚Äì Tidsrapport</title>
<meta name="theme-color" content="#1f6b3b" />
<link rel="icon" href="favicon.ico" />
<style>
  :root{
    --brand: #1f6b3b;     /* toppmeny, knappar */
    --brand-2:#0f3e23;    /* m√∂rkare skugga */
    --accent:#ffffff;     /* knapptxt */
    --chip:#eaf4ee;       /* sm√•f√§lt */
    --text:#102017;       /* huvudtext */
  }
  /* Kamouflage-tema aktiveras genom att s√§tta data-theme="camo" p√• body */
  body[data-theme="camo"]{
    --brand:#2f4f3a;
    --brand-2:#1e3426;
    --chip:#eef3ef;
    --text:#0e1a14;
    background:
      radial-gradient( circle at 15% 20%, #6b8f6a 0 20%, transparent 21%),
      radial-gradient( circle at 80% 10%, #3f5b46 0 16%, transparent 17%),
      radial-gradient( circle at 70% 70%, #5b6e54 0 22%, transparent 23%),
      radial-gradient( circle at 20% 80%, #8aa27c 0 18%, transparent 19%),
      #f7faf7;
    background-attachment: fixed;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family: system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif;
    color:var(--text);
  }
  .topbar{
    position:sticky; top:0; z-index:10;
    background: linear-gradient(0deg,var(--brand) 0%, var(--brand-2) 100%);
    color:#fff; padding:.8rem .9rem; display:flex; align-items:center; gap:12px;
    box-shadow: 0 2px 10px rgba(0,0,0,.2);
  }
  .logo{
    width:36px;height:36px;border-radius:8px;background:#fff;overflow:hidden;display:grid;place-items:center;flex:0 0 auto;
  }
  .logo img{max-width:100%;max-height:100%;display:block}
  .title{font-weight:800; line-height:1.05}
  .subtitle{font-weight:500; opacity:.85; font-size:.9rem}
  .spacer{flex:1}
  .pill{
    background:#fff; color:#222; border-radius:16px; padding:.55rem .8rem; font-weight:700;
    display:inline-flex; align-items:center; gap:.5rem; box-shadow:0 2px 8px rgba(0,0,0,.15);
  }
  .pill.dark{background:#111; color:#fff}
  main{padding:16px}
  .card{
    background:#f2f7f4; border-radius:14px; padding:12px 16px; box-shadow:0 10px 20px rgba(0,0,0,.06);
  }
  .sumtitle{display:flex;align-items:center;gap:.6rem;font-weight:800}
  .table-wrap{
    overflow:auto; margin-top:10px; background:#fff; border-radius:14px; box-shadow:0 10px 20px rgba(0,0,0,.06);
    position:relative;
  }
  table{border-collapse:separate;border-spacing:12px; min-width:900px; width:100%}
  th,td{white-space:nowrap}
  thead th{
    position:sticky; top:0; background:#eaf4ee; padding:.8rem .9rem; border-radius:12px; text-align:left; font-weight:800; z-index:1;
  }
  tbody td{padding:0}
  .chip{
    background:var(--chip); border-radius:14px; padding:.8rem .9rem; display:flex; align-items:center; gap:.5rem;
    border:1px solid #dfe9e3;
  }
  .num{font-weight:800; width:3.2rem; display:grid; place-items:center; background:#f0f6f2; border:1px solid #e5efe9; border-radius:14px}
  .time{
    width:9.8rem; display:flex; align-items:center; justify-content:space-between; gap:.25rem;
  }
  select,input[type=time],input[type=text]{border:none; background:transparent; font:inherit; color:inherit; width:100%}
  .btn{
    background:var(--brand); color:var(--accent); border:none; padding:.8rem; border-radius:14px; min-width:3.1rem;
    display:grid; place-items:center; box-shadow:0 10px 16px rgba(0,0,0,.14);
  }
  .row{display:grid; grid-template-columns:4.2rem 11rem 11rem 10rem 6rem 11rem 8rem; gap:12px; align-items:center}
  .right{display:flex; gap:12px; justify-content:flex-end}
  .fab{
    position:fixed; left:16px; bottom:16px; z-index:11;
    width:64px;height:64px;border-radius:18px;background:var(--brand);color:#cfe9db; display:grid; place-items:center;
    box-shadow:0 14px 28px rgba(0,0,0,.25);
  }
  .fab span{font-size:28px}
  .footerpad{height:110px} /* s√• FAB inte t√§cker sista raden */
  /* Modal */
  .modal-back{position:fixed;inset:0;background:rgba(0,0,0,.35);display:none;place-items:center;z-index:20}
  .modal{width:min(620px,92vw); background:#fff; border-radius:18px; padding:18px; box-shadow:0 20px 40px rgba(0,0,0,.35)}
  .modal h3{margin:.2rem 0 1rem; font-size:1.25rem}
  .grid-2{display:grid; grid-template-columns:1fr 1fr; gap:12px}
  .field{background:#f5faf7;border:1px solid #e1eee7;border-radius:12px;padding:.6rem .7rem}
  .field label{display:block;font-size:.8rem;opacity:.75;margin-bottom:.2rem}
  .row-end{display:flex;gap:8px;justify-content:flex-end;margin-top:12px}
  .ghost{background:#eef4f0;color:#0e271a}
  .range-row{display:flex;align-items:center;gap:10px}
  input[type=range]{width:100%}
  .theme-samples{display:flex;gap:8px;flex-wrap:wrap}
  .swatch{width:42px;height:28px;border-radius:8px;border:2px solid #0001;cursor:pointer}
  .swatch.camo{background:
      radial-gradient( circle at 30% 40%, #6b8f6a 0 50%, transparent 51%),
      radial-gradient( circle at 70% 30%, #3f5b46 0 45%, transparent 46%),
      radial-gradient( circle at 60% 75%, #5b6e54 0 55%, transparent 56%),
      #2f4f3a;}
  /* Vattenst√§mpel */
  .wm{
    position:fixed; right:18px; bottom:88px; width:260px; aspect-ratio:1.3/1;
    opacity:.7; pointer-events:none; z-index:0; mix-blend-mode:multiply;
  }
  .wm img{width:100%; height:100%; object-fit:contain; filter:grayscale(20%) contrast(1.05)}
  /* Hj√§lp f√∂r sm√• sk√§rmar: rad bryts snyggt */
  @media (max-width:480px){
    .row{grid-template-columns:3.8rem 10.6rem 10.6rem 9.6rem 6rem 10.6rem 8rem}
  }
</style>
</head>
<body>
  <div class="topbar">
    <div class="logo"><img id="logoImg" alt="logo" src="tnh-tree-192.png"></div>
    <div style="min-width:0">
      <div class="title" id="titleTxt">Tannenhofs tidtabell</div>
      <div class="subtitle" id="monthTxt"></div>
    </div>
    <div class="spacer"></div>
    <button class="pill" id="shareBtn">üç∞ <span id="shareTxt">Dela / Skicka</span></button>
    <button class="pill dark" id="printBtn">üñ®Ô∏è <span id="printTxt">Skriv ut / PDF</span></button>
  </div>

  <main>
    <div class="card">
      <div class="sumtitle">‚è≥ <span id="sumHdr">Totalt ‚Äì </span><span id="sumMonth"></span><div class="spacer"></div><strong id="sumHours">0.00</strong></div>
    </div>

    <div class="table-wrap" id="tblWrap" aria-label="timesheet">
      <table>
        <thead>
          <tr class="row">
            <th id="hDay">Dag</th>
            <th id="hFrom">Fr√•n</th>
            <th id="hTo">Till</th>
            <th id="hBreak">Paus</th>
            <th id="hTotal">Totalt</th>
            <th id="hProject">Projekt/plats</th>
            <th id="hAction">√Ötg√§rd</th>
          </tr>
        </thead>
        <tbody id="bodyRows"></tbody>
      </table>
    </div>

    <div class="footerpad"></div>
  </main>

  <!-- FAB settings -->
  <button class="fab" id="fab" aria-label="Inst√§llningar"><span>‚öôÔ∏è</span></button>

  <!-- Modal -->
  <div class="modal-back" id="modalBack">
    <div class="modal">
      <h3 id="setHdr">Inst√§llningar</h3>
      <div class="grid-2">
        <div class="field">
          <label id="lblCompany">F√∂retagsnamn</label>
          <input id="inpCompany" type="text" placeholder="TH√úRINGER TANNENHOF"/>
        </div>
        <div class="field">
          <label id="lblLang">Spr√•k</label>
          <select id="selLang">
            <option value="sv">Svenska</option>
            <option value="de">Deutsch</option>
            <option value="en">English</option>
          </select>
        </div>
        <div class="field">
          <label id="lblWm">Vattenst√§mpel</label>
          <div class="range-row">
            <input id="rngWM" type="range" min="0" max="100" step="1" />
            <span id="rngVal">70%</span>
          </div>
        </div>
        <div class="field">
          <label id="lblLogo">Byt logga</label>
          <input id="fileLogo" type="file" accept="image/*" />
        </div>

        <div class="field">
          <label id="lblTheme">Tema</label>
          <div class="theme-samples">
            <div class="swatch" id="swatchGreen" style="background:linear-gradient(0deg,#1f6b3b,#0f3e23)"></div>
            <div class="swatch camo" id="swatchCamo" title="Kamouflage"></div>
            <div class="swatch" id="swatchCustom" style="display:grid;place-items:center">üé®</div>
          </div>
        </div>
        <div class="field" id="customColors" style="display:none">
          <label id="lblPick">V√§lj egna f√§rger</label>
          <div class="grid-2">
            <div><small>Prim√§r</small><input type="color" id="pickBrand" value="#1f6b3b" style="width:100%"></div>
            <div><small>M√∂rk</small><input type="color" id="pickBrand2" value="#0f3e23" style="width:100%"></div>
          </div>
        </div>
      </div>
      <div class="row-end">
        <button class="pill ghost" id="btnReset">√Öterst√§ll</button>
        <button class="pill" id="btnClose">St√§ng</button>
      </div>
    </div>
  </div>

  <!-- Watermark -->
  <div class="wm" id="wm"><img id="wmImg" src="tnh-tree-512.png" alt="wm"></div>

<script>
/* ---------- i18n ---------- */
const i18n = {
  sv:{
    title:"Tannenhofs tidtabell",
    share:"Dela / Skicka",
    print:"Skriv ut / PDF",
    total:"Totalt ‚Äì ",
    heads:["Dag","Fr√•n","Till","Paus","Totalt","Projekt/plats","√Ötg√§rd"],
    settings:"Inst√§llningar", company:"F√∂retagsnamn", lang:"Spr√•k",
    wm:"Vattenst√§mpel", logo:"Byt logga", theme:"Tema", pick:"V√§lj egna f√§rger",
    note:"Notis", projectPH:"Projekt/plats", action:"√Ötg√§rd",
    write:"‚úçÔ∏è", camera:"üì∑"
  },
  de:{
    title:"Tannenhofs Zeittabelle",
    share:"Teilen / Senden",
    print:"Drucken / PDF",
    total:"Gesamt ‚Äì ",
    heads:["Tag","Von","Bis","Pause","Gesamt","Projekt/Ort","Aktion"],
    settings:"Einstellungen", company:"Firmenname", lang:"Sprache",
    wm:"Wasserzeichen", logo:"Logo wechseln", theme:"Thema", pick:"Eigene Farben w√§hlen",
    note:"Notiz", projectPH:"Projekt/Ort", action:"Aktion",
    write:"‚úçÔ∏è", camera:"üì∑"
  },
  en:{
    title:"Tannenhof Timesheet",
    share:"Share / Send",
    print:"Print / PDF",
    total:"Total ‚Äì ",
    heads:["Day","From","To","Break","Total","Project/site","Action"],
    settings:"Settings", company:"Company name", lang:"Language",
    wm:"Watermark", logo:"Change logo", theme:"Theme", pick:"Pick custom colors",
    note:"Note", projectPH:"Project/site", action:"Action",
    write:"‚úçÔ∏è", camera:"üì∑"
  }
};
let lang = localStorage.getItem("tnh_lang") || "sv";

/* ---------- State ---------- */
const state = {
  month:new Date().getMonth(), year:new Date().getFullYear(),
  wmOpacity: Number(localStorage.getItem("tnh_wm") ?? 70),
  logoData: localStorage.getItem("tnh_logo") || "",
  company: localStorage.getItem("tnh_company") || "TH√úRINGER TANNENHOF",
  theme: localStorage.getItem("tnh_theme") || "green",
  brand: localStorage.getItem("tnh_brand") || "",
  brand2: localStorage.getItem("tnh_brand2") || ""
};

/* ---------- Helpers ---------- */
function monthName(y,m, l=lang){
  const f = new Intl.DateTimeFormat(l, {month:"long", year:"numeric"});
  return f.format(new Date(y,m,1));
}
function pad2(n){return (n<10?"0":"")+n;}
function diffHours(from,to,brk){
  if(!from || !to) return 0;
  const [fh,fm] = from.split(":").map(Number);
  const [th,tm] = to.split(":").map(Number);
  let mins = (th*60+tm) - (fh*60+fm) - (parseInt(brk||"0")||0);
  if (mins<0) mins += 24*60; // √∂ver midnatt fallback
  return Math.max(0, mins)/60;
}
function saveLS(){  // spara enklare preferenser
  localStorage.setItem("tnh_lang", lang);
  localStorage.setItem("tnh_company", state.company);
  localStorage.setItem("tnh_wm", String(state.wmOpacity));
  localStorage.setItem("tnh_logo", state.logoData);
  localStorage.setItem("tnh_theme", state.theme);
  if(state.brand) localStorage.setItem("tnh_brand", state.brand);
  if(state.brand2) localStorage.setItem("tnh_brand2", state.brand2);
}

/* ---------- Build table ---------- */
const bodyRows = document.getElementById("bodyRows");
function daysInMonth(y,m){ return new Date(y,m+1,0).getDate(); }

function buildRows(){
  bodyRows.innerHTML="";
  const days = daysInMonth(state.year, state.month);
  for(let d=1; d<=days; d++){
    const tr = document.createElement("tr");
    tr.className="row";
    // Dag
    const tdNum = document.createElement("td");
    tdNum.innerHTML = `<div class="num">${d}</div>`;
    tr.appendChild(tdNum);
    // Fr√•n
    const tdF = document.createElement("td");
    tdF.innerHTML = `<div class="chip time">‚è∞ <input type="time" value=""> <select><option></option></select></div>`;
    tr.appendChild(tdF);
    // Till
    const tdT = document.createElement("td");
    tdT.innerHTML = `<div class="chip time">üïì <input type="time" value=""> <select><option></option></select></div>`;
    tr.appendChild(tdT);
    // Paus
    const tdP = document.createElement("td");
    tdP.innerHTML = `<div class="chip time">‚òï <input type="time" value="00:00"></div>`;
    tr.appendChild(tdP);
    // Totalt
    const tdTot = document.createElement("td");
    tdTot.innerHTML = `<div class="chip" data-tot>0.00</div>`;
    tr.appendChild(tdTot);
    // Projekt
    const tdProj = document.createElement("td");
    tdProj.innerHTML = `<div class="chip"><span style="font-size:18px">üß±</span> <input type="text" placeholder="${i18n[lang].projectPH}"></div>`;
    tr.appendChild(tdProj);
    // √Ötg√§rd (anteckning + kamera)
    const tdAct = document.createElement("td");
    tdAct.innerHTML = `
      <div class="right">
        <button class="btn" title="Anteckning">${i18n[lang].write}</button>
        <button class="btn camBtn" title="Kamera">${i18n[lang].camera}</button>
      </div>`;
    tr.appendChild(tdAct);

    bodyRows.appendChild(tr);
  }
  wireRowEvents();
  updateTexts();
  updateMonthText();
}
function wireRowEvents(){
  bodyRows.querySelectorAll("tr").forEach(tr=>{
    const [ , fromTd, toTd, brkTd ] = tr.children;
    const from = fromTd.querySelector('input[type="time"]');
    const to   = toTd.querySelector('input[type="time"]');
    const brk  = brkTd.querySelector('input[type="time"]');
    const out  = tr.querySelector('[data-tot]');
    function calc(){
      const brkMin = (brk.value||"00:00").split(":").map(Number);
      const mins = brkMin[0]*60 + brkMin[1];
      const h = diffHours(from.value,to.value, mins);
      out.textContent = h.toFixed(2);
      sumAll();
    }
    from.addEventListener("change",calc);
    to.addEventListener("change",calc);
    brk.addEventListener("change",calc);

    // Kamera/Galleri-val
    tr.querySelectorAll(".camBtn").forEach(btn=>{
      btn.addEventListener("click", ()=>openCameraMenu());
    });
  });
}

/* ---------- Sum ---------- */
function sumAll(){
  let sum=0;
  bodyRows.querySelectorAll('[data-tot]').forEach(n=> sum+= Number(n.textContent||0));
  document.getElementById("sumHours").textContent = sum.toFixed(2);
}

/* ---------- Watermark & Logo ---------- */
const wm = document.getElementById("wm");
const wmImg = document.getElementById("wmImg");
function applyWM(){
  wm.style.opacity = (state.wmOpacity/100).toFixed(2);
  const rng = document.getElementById("rngWM");
  const lbl = document.getElementById("rngVal");
  if(rng){ rng.value = state.wmOpacity; }
  if(lbl){ lbl.textContent = state.wmOpacity + "%"; }
  if(state.logoData){
    wmImg.src = state.logoData;
    document.getElementById("logoImg").src = state.logoData;
  }
}

/* ---------- Settings modal ---------- */
const modalBack = document.getElementById("modalBack");
document.getElementById("fab").onclick = ()=> modalBack.style.display="grid";
document.getElementById("btnClose").onclick = ()=> { modalBack.style.display="none"; saveLS(); };
document.getElementById("btnReset").onclick = ()=>{
  localStorage.removeItem("tnh_logo");
  localStorage.removeItem("tnh_brand");
  localStorage.removeItem("tnh_brand2");
  localStorage.removeItem("tnh_theme");
  state.logoData=""; state.brand=""; state.brand2=""; state.theme="green";
  document.getElementById("logoImg").src="tnh-tree-192.png";
  wmImg.src="tnh-tree-512.png";
  document.body.removeAttribute("data-theme");
  setBrand("#1f6b3b","#0f3e23");
  applyWM();
};

document.getElementById("selLang").onchange = (e)=>{ lang = e.target.value; saveLS(); updateTexts(); };

document.getElementById("rngWM").oninput = (e)=>{ state.wmOpacity = Number(e.target.value); applyWM(); };

document.getElementById("fileLogo").onchange = (e)=>{
  const f = e.target.files?.[0];
  if(!f) return;
  const rdr = new FileReader();
  rdr.onload = ()=>{ state.logoData = rdr.result; applyWM(); saveLS(); };
  rdr.readAsDataURL(f);
};

/* ---------- Theme handling ---------- */
function setBrand(b1,b2){
  document.documentElement.style.setProperty('--brand', b1);
  document.documentElement.style.setProperty('--brand-2', b2);
  document.querySelector('meta[name="theme-color"]').setAttribute('content', b1);
}
document.getElementById("swatchGreen").onclick = ()=>{
  state.theme="green"; document.body.removeAttribute("data-theme");
  document.getElementById("customColors").style.display="none";
  setBrand("#1f6b3b","#0f3e23"); saveLS();
};
document.getElementById("swatchCamo").onclick = ()=>{
  state.theme="camo"; document.body.setAttribute("data-theme","camo");
  document.getElementById("customColors").style.display="none";
  saveLS();
};
document.getElementById("swatchCustom").onclick = ()=>{
  state.theme="custom"; document.body.removeAttribute("data-theme");
  document.getElementById("customColors").style.display="";
  const b1 = state.brand || "#1f6b3b";
  const b2 = state.brand2|| "#0f3e23";
  setBrand(b1,b2); saveLS();
};
document.getElementById("pickBrand").oninput = (e)=>{ state.brand = e.target.value; setBrand(state.brand, state.brand2||"#0f3e23"); saveLS(); };
document.getElementById("pickBrand2").oninput = (e)=>{ state.brand2= e.target.value; setBrand(state.brand||"#1f6b3b", state.brand2); saveLS(); };

/* ---------- Camera menu (kamera/galleri) ---------- */
function openCameraMenu(){
  // Skapa tv√• inputs dynamiskt s√• Android visar val
  const wrap = document.createElement("div");
  wrap.style.position="fixed"; wrap.style.inset="0"; wrap.style.display="grid"; wrap.style.placeItems="center";
  wrap.style.background="rgba(0,0,0,.35)"; wrap.style.zIndex="50";
  const box = document.createElement("div");
  box.style.background="#fff"; box.style.padding="14px"; box.style.borderRadius="12px"; box.style.display="grid"; box.style.gap="8px";
  const cam = document.createElement("input");
  cam.type="file"; cam.accept="image/*"; cam.capture="environment";
  const gal = document.createElement("input");
  gal.type="file"; gal.accept="image/*";
  const lab1 = document.createElement("label"); lab1.textContent="üì∑ Kamera"; lab1.className="pill"; lab1.style.cursor="pointer";
  const lab2 = document.createElement("label"); lab2.textContent="üñºÔ∏è Galleri"; lab2.className="pill"; lab2.style.cursor="pointer";
  lab1.appendChild(cam); lab2.appendChild(gal);
  const close = document.createElement("button"); close.textContent="St√§ng"; close.className="pill ghost";
  close.onclick = ()=> document.body.removeChild(wrap);
  box.append(lab1, lab2, close); wrap.append(box); document.body.append(wrap);
  const handle = (e)=>{
    const f = e.target.files?.[0]; if(!f){ document.body.removeChild(wrap); return; }
    // H√§r kan du ladda upp eller bara visa kvitto
    const toast = document.createElement("div");
    toast.textContent = "‚úÖ Bild vald";
    toast.style.position="fixed"; toast.style.bottom="18px"; toast.style.left="50%"; toast.style.transform="translateX(-50%)";
    toast.style.background="#111"; toast.style.color="#fff"; toast.style.padding="8px 12px"; toast.style.borderRadius="10px";
    toast.style.zIndex="60";
    document.body.append(toast);
    setTimeout(()=>toast.remove(),1600);
    document.body.removeChild(wrap);
  };
  cam.onchange = handle; gal.onchange = handle;
}

/* ---------- Text/labels ---------- */
function updateTexts(){
  const t = i18n[lang];
  document.getElementById("titleTxt").textContent = t.title;
  document.getElementById("shareTxt").textContent = t.share;
  document.getElementById("printTxt").textContent = t.print;
  document.getElementById("sumHdr").textContent = t.total;
  document.getElementById("hDay").textContent = t.heads[0];
  document.getElementById("hFrom").textContent = t.heads[1];
  document.getElementById("hTo").textContent = t.heads[2];
  document.getElementById("hBreak").textContent = t.heads[3];
  document.getElementById("hTotal").textContent = t.heads[4];
  document.getElementById("hProject").textContent = t.heads[5];
  document.getElementById("hAction").textContent = t.heads[6];

  document.getElementById("setHdr").textContent = t.settings;
  document.getElementById("lblCompany").textContent = t.company;
  document.getElementById("lblLang").textContent = t.lang;
  document.getElementById("lblWm").textContent = t.wm;
  document.getElementById("lblLogo").textContent = t.logo;
  document.getElementById("lblTheme").textContent = t.theme;
  document.getElementById("lblPick").textContent = t.pick;

  // uppdatera placeholders p√• befintliga rader
  document.querySelectorAll('input[placeholder]').forEach(el=>{
    if(el.placeholder.includes("Projekt")) el.placeholder = t.projectPH;
  });

  // uppdatera spr√•kval & company i modal
  document.getElementById("selLang").value = lang;
  document.getElementById("inpCompany").value = state.company;
  document.getElementById("monthTxt").textContent = monthName(state.year, state.month, lang);
  document.getElementById("sumMonth").textContent = monthName(state.year, state.month, lang);
}
function updateMonthText(){
  document.getElementById("monthTxt").textContent = monthName(state.year, state.month, lang);
  document.getElementById("sumMonth").textContent = monthName(state.year, state.month, lang);
}

/* ---------- Company binding ---------- */
document.getElementById("inpCompany").addEventListener("input", (e)=>{
  state.company = e.target.value || "TH√úRINGER TANNENHOF";
  document.getElementById("titleTxt").textContent = state.company ? state.company + " ‚Äì " + i18n[lang].title.split(" ").slice(-1).join(" ") : i18n[lang].title;
});

/* ---------- Init ---------- */
(function init(){
  // √•terst√§ll tema
  if(state.theme==="camo"){ document.body.setAttribute("data-theme","camo"); }
  if(state.theme==="custom"){
    document.body.removeAttribute("data-theme");
    const b1 = state.brand || "#1f6b3b";
    const b2 = state.brand2|| "#0f3e23";
    setBrand(b1,b2);
    document.getElementById("customColors").style.display="";
  }
  document.getElementById("rngWM").value = state.wmOpacity;
  document.getElementById("rngVal").textContent = state.wmOpacity+"%";
  document.getElementById("inpCompany").value = state.company;
  if(state.logoData){
    document.getElementById("logoImg").src = state.logoData;
    wmImg.src = state.logoData;
  }
  applyWM();
  buildRows();
  sumAll();
  // Lagra p√• st√§ngning
  window.addEventListener("beforeunload", saveLS);
})();
</script>
</body>
</html>
