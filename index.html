<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Tannenhofs tidtabell</title>
  <link rel="icon" href="favicon.ico">
  <link rel="apple-touch-icon" href="apple-touch-icon.png">
  <link rel="manifest" href="manifest.webmanifest">
  <style>
    :root {
      --green: #2f6b3a;
      --green-2: #2d5f35;
      --soft: #eaf3ed;
      --shadow: 0 6px 18px rgba(0, 0, 0, 0.1);
      --radius: 14px;
      --ink: #203328;
      --muted: #6a7d72;
    }
    body {
      margin: 0;
      font-family: system-ui, sans-serif;
      background: #f2f6f4;
      color: var(--ink);
      overflow-x: auto;
    }
    header {
      background: linear-gradient(0deg, var(--green-2), var(--green));
      color: white;
      padding: 10px;
      position: sticky;
      top: 0;
      z-index: 10;
      box-shadow: var(--shadow);
    }
    .head-inner {
      display: flex;
      align-items: center;
      justify-content: space-between;
      max-width: 1000px;
      margin: auto;
    }
    .brand {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .logo {
      width: 36px;
      height: 36px;
      border-radius: 10px;
      overflow: hidden;
      background: #1c3e22;
    }
    .logo img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .title b {
      display: block;
      font-size: 18px;
    }
    .title small {
      opacity: 0.8;
      font-size: 14px;
    }
    .head-actions {
      display: flex;
      gap: 10px;
    }
    .btn {
      background: white;
      border: 0;
      padding: 9px 12px;
      border-radius: 10px;
      font-weight: 600;
      cursor: pointer;
      box-shadow: var(--shadow);
    }
    .btn-primary {
      background: #143d23;
      color: white;
    }
    .wrap {
      max-width: 1000px;
      margin: auto;
      padding: 12px;
    }
    .sum-banner {
      background: white;
      border-radius: var(--radius);
      padding: 12px;
      margin: 10px 0;
      box-shadow: var(--shadow);
      font-weight: bold;
      display: flex;
      justify-content: space-between;
    }
    .table {
      background: white;
      border-radius: var(--radius);
      overflow-x: auto;
      box-shadow: var(--shadow);
    }
    .row {
      display: grid;
      grid-template-columns: 50px 1fr 1fr 100px 100px 60px;
      gap: 6px;
      align-items: center;
      padding: 10px;
      border-bottom: 1px solid #eef3ef;
    }
    .row:nth-child(even) {
      background: #f7fbf8;
    }
    .row.header {
      background: var(--soft);
      font-weight: bold;
    }
    .row.today {
      background: #e6f3e9;
      outline: 2px solid #1b8a46;
    }
    input[type="time"], select {
      width: 100%;
      padding: 8px;
      border: 1px solid #dfeae3;
      border-radius: 10px;
      font: inherit;
    }
    .note-btn {
      background: var(--green-2);
      color: white;
      border: 0;
      border-radius: 10px;
      width: 38px;
      height: 38px;
      cursor: pointer;
    }
    .fab {
      position: fixed;
      left: 16px;
      bottom: 16px;
      width: 56px;
      height: 56px;
      border-radius: 16px;
      border: 0;
      background: var(--green-2);
      color: white;
      font-size: 22px;
      box-shadow: var(--shadow);
    }
    .drawer {
      position: fixed;
      right: 0;
      top: 0;
      bottom: 0;
      width: min(420px, 90vw);
      background: white;
      transform: translateX(100%);
      transition: 0.25s;
      box-shadow: -10px 0 20px rgba(0, 0, 0, 0.2);
      z-index: 100;
      display: flex;
      flex-direction: column;
    }
    .drawer.open {
      transform: translateX(0);
    }
    .drawer header {
      background: var(--green);
      color: white;
      padding: 12px;
    }
    .drawer .panel {
      padding: 12px;
      overflow: auto;
      flex: 1;
    }
    .drawer .closebar {
      border-top: 1px solid #eef3ef;
      padding: 12px;
      text-align: right;
    }
    .watermark {
      position: fixed;
      right: 16px;
      bottom: 16px;
      opacity: 0.18;
      pointer-events: none;
    }
    .watermark img {
      width: 160px;
      height: auto;
    }
  </style>
</head>
<body>
<header>
  <div class="head-inner">
    <div class="brand">
      <div class="logo"><img id="topLogo"></div>
      <div class="title">
        <b id="titleMain">Tannenhofs tidtabell</b>
        <small id="monthTitle"></small>
      </div>
    </div>
    <div class="head-actions">
      <button id="shareBtn" class="btn">Dela / Skicka</button>
      <button id="printBtn" class="btn btn-primary">Skriv ut / PDF</button>
    </div>
  </div>
</header>

<div class="wrap">
  <div class="sum-banner">
    <span id="sumLabel"></span>
    <span id="sumHours">0.00</span>
  </div>

  <div id="table" class="table"></div>
</div>

<button id="settingsBtn" class="fab">‚öôÔ∏è</button>
<div id="wm" class="watermark"><img id="wmImg" src="tnh-tree-192.png"></div>

<aside id="drawer" class="drawer">
  <header><b id="settingsTitle">Inst√§llningar</b></header>
  <div class="panel">
    <label>F√∂retag</label>
    <input id="company" type="text" placeholder="Th√ºringer Tannenhof">
    <label>Logga</label>
    <input id="logoFile" type="file" accept="image/*">
    <label>Spr√•k</label>
    <select id="lang">
      <option value="sv">Svenska</option>
      <option value="de">Deutsch</option>
      <option value="en">English</option>
    </select>
    <label>Visa vattenst√§mpel</label>
    <input id="wmToggle" type="checkbox" checked>
    <button id="genBtn" class="btn">Skapa dagar</button>
  </div>
  <div class="closebar"><button id="closeDrawer" class="btn">St√§ng</button></div>
</aside>

<script>
const $ = sel => document.querySelector(sel);
const langStrings = {
  sv: { total: "Totalt ‚Äì", settings: "Inst√§llningar", print: "Skriv ut / PDF", share: "Dela / Skicka" },
  de: { total: "Gesamt ‚Äì", settings: "Einstellungen", print: "Drucken / PDF", share: "Teilen / Senden" },
  en: { total: "Total ‚Äì", settings: "Settings", print: "Print / PDF", share: "Share / Send" }
};
let lang = "sv";
const state = { days: [] };

function setLang(l) {
  lang = l;
  const t = langStrings[l];
  $("#titleMain").textContent = "Tannenhofs tidtabell";
  $("#settingsTitle").textContent = t.settings;
  $("#printBtn").textContent = t.print;
  $("#shareBtn").textContent = t.share;
  $("#sumLabel").textContent = `${t.total} ${new Date().toLocaleString(l, { month: "long", year: "numeric" })}`;
}

function genTable() {
  const table = $("#table");
  table.innerHTML = "";
  const header = document.createElement("div");
  header.className = "row header";
  header.innerHTML = "<div>Dag</div><div>Fr√•n</div><div>Till</div><div>Paus</div><div>Totalt</div><div>Notis</div>";
  table.appendChild(header);
  const today = new Date();
  for (let i = 1; i <= 31; i++) {
    const r = document.createElement("div");
    r.className = "row" + (i === today.getDate() ? " today" : "");
    r.innerHTML = `
      <div>${i}</div>
      <div><input type="time"></div>
      <div><input type="time"></div>
      <div><input type="time" value="00:00"></div>
      <div>0.00</div>
      <div><button class="note-btn">üìù</button></div>`;
    table.appendChild(r);
  }
}

$("#settingsBtn").onclick = () => $("#drawer").classList.add("open");
$("#closeDrawer").onclick = () => $("#drawer").classList.remove("open");
$("#genBtn").onclick = () => { genTable(); $("#drawer").classList.remove("open"); };
$("#wmToggle").onchange = e => $("#wm").style.display = e.target.checked ? "block" : "none";
$("#lang").onchange = e => setLang(e.target.value);
$("#printBtn").onclick = () => window.print();
$("#shareBtn").onclick = async () => {
  try {
    await navigator.share({ title: "Tannenhofs tidtabell", url: location.href });
  } catch {}
};
$("#logoFile").onchange = e => {
  const f = e.target.files[0];
  if (!f) return;
  const r = new FileReader();
  r.onload = ev => {
    $("#topLogo").src = ev.target.result;
    $("#wmImg").src = ev.target.result;
  };
  r.readAsDataURL(f);
};
setLang("sv");
genTable();
</script>
</body>
</html>
